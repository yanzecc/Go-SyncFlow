import{v as e,k as a,D as l,E as t,F as s,ac as u,r as o,y as n,P as r,z as d,S as i,U as p,G as c,am as v,ad as g}from"./vendor-DDTA3iPl.js";import{f as m,_ as y}from"./index-D9Oaf6TO.js";import"./elementPlus-DW6qdM9Z.js";const f={class:"page-container"},h={class:"filter-row"},w={class:"pagination-row"},b={class:"total-text"},_=y(e({__name:"SystemLogs",setup(e){const y=o(!1),_=o([]),z=o(0),V=o(1),x=o(20),U=o(""),k=o(""),C=o([]),D=async()=>{var e,a,l;y.value=!0;try{const t={page:V.value,size:x.value};U.value&&(t.type=U.value),k.value&&(t.keyword=k.value),2===(null==(e=C.value)?void 0:e.length)&&(t.startDate=C.value[0],t.endDate=C.value[1]);const s=await m.get("/logs/system",{params:t});s.data.success&&(_.value=(null==(a=s.data.data)?void 0:a.list)||[],z.value=(null==(l=s.data.data)?void 0:l.total)||0)}finally{y.value=!1}};return a(D),(e,a)=>{const o=u("el-option"),m=u("el-select"),P=u("el-input"),S=u("el-date-picker"),Y=u("el-button"),j=u("el-table-column"),T=u("el-tag"),I=u("el-table"),M=u("el-pagination"),A=u("el-card"),E=g("loading");return n(),l("div",f,[t(A,{class:"table-card"},{header:s(()=>[c("div",h,[t(m,{modelValue:U.value,"onUpdate:modelValue":a[0]||(a[0]=e=>U.value=e),placeholder:"日志类型",clearable:"",style:{width:"130px"},onChange:D},{default:s(()=>[t(o,{label:"全部",value:""}),t(o,{label:"登录日志",value:"login"}),t(o,{label:"操作日志",value:"operation"})]),_:1},8,["modelValue"]),t(P,{modelValue:k.value,"onUpdate:modelValue":a[1]||(a[1]=e=>k.value=e),placeholder:"用户名",clearable:"",style:{width:"160px"},onKeyup:v(D,["enter"])},null,8,["modelValue"]),t(S,{modelValue:C.value,"onUpdate:modelValue":a[2]||(a[2]=e=>C.value=e),type:"daterange","start-placeholder":"开始","end-placeholder":"结束","value-format":"YYYY-MM-DD",style:{width:"260px"}},null,8,["modelValue"]),t(Y,{type:"primary",onClick:D},{default:s(()=>[...a[5]||(a[5]=[i("搜索",-1)])]),_:1})])]),default:s(()=>[r((n(),d(I,{data:_.value,stripe:"",size:"small"},{default:s(()=>[t(j,{label:"时间",width:"170"},{default:s(({row:e})=>{return[i(p((a=e.createdAt,a?a.replace("T"," ").slice(0,19):"")),1)];var a}),_:1}),t(j,{prop:"username",label:"用户",width:"140"}),t(j,{label:"类型",width:"100",align:"center"},{default:s(({row:e})=>[t(T,{type:"login"===e.logType?"primary":"warning",size:"small"},{default:s(()=>[i(p("login"===e.logType?"登录":"操作"),1)]),_:2},1032,["type"])]),_:1}),t(j,{label:"描述","min-width":"300"},{default:s(({row:e})=>[c("span",null,p(e.summary),1)]),_:1}),t(j,{label:"状态",width:"80",align:"center"},{default:s(({row:e})=>[t(T,{type:"success"===e.status?"success":"danger",size:"small"},{default:s(()=>[i(p("success"===e.status?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1}),t(j,{prop:"ip",label:"IP",width:"140"})]),_:1},8,["data"])),[[E,y.value]]),c("div",w,[c("span",b,"共 "+p(z.value)+" 条",1),t(M,{background:"",layout:"sizes, prev, pager, next",total:z.value,"current-page":V.value,"onUpdate:currentPage":a[3]||(a[3]=e=>V.value=e),"page-size":x.value,"onUpdate:pageSize":a[4]||(a[4]=e=>x.value=e),"page-sizes":[20,50,100],onCurrentChange:D,onSizeChange:D},null,8,["total","current-page","page-size"])])]),_:1})])}}}),[["__scopeId","data-v-3f5cc527"]]);export{_ as default};
