import{l as e,_ as a}from"./index-D9Oaf6TO.js";import{v as l,k as t,D as s,E as r,F as d,ac as n,r as i,l as o,y as u,P as p,z as c,G as g,U as v,S as m,ad as y}from"./vendor-DDTA3iPl.js";import"./elementPlus-DW6qdM9Z.js";const _={class:"page-container"},h={class:"filter-row"},w={class:"expand-content"},f={key:0,class:"detail-raw"},b={key:1,class:"detail-empty"},z={class:"pagination-row"},V={class:"total-text"},x=a(l({__name:"SyncLogs",setup(a){const l=i(!1),x=i([]),C=o({direction:"",event:"",status:"",dateRange:null}),k=o({page:1,size:20,total:0}),R={event:"事件",schedule:"定时",manual:"手动"},U={password_change:"密码修改",full_sync:"全量同步",user_create:"用户创建",user_update:"用户更新",user_delete:"用户删除",user_status_change:"状态变更",role_change:"角色变更",dingtalk_sync:"钉钉同步"},D={success:"成功",partial:"部分成功",failed:"失败"},S=async()=>{var a;l.value=!0;try{const l={page:k.page,size:k.size,event:C.event||void 0,status:C.status||void 0,direction:C.direction||void 0};C.dateRange&&2===C.dateRange.length&&(l.startDate=C.dateRange[0],l.endDate=C.dateRange[1]);const t=null==(a=(await e.syncLogs(l)).data)?void 0:a.data;x.value=(null==t?void 0:t.list)||[],k.total=(null==t?void 0:t.total)||0}finally{l.value=!1}};return t(S),(e,a)=>{const t=n("el-option"),i=n("el-select"),o=n("el-date-picker"),T=n("el-button"),E=n("el-table-column"),Y=n("el-tag"),j=n("el-table"),L=n("el-pagination"),P=n("el-card"),M=y("loading");return u(),s("div",_,[r(P,{class:"table-card"},{header:d(()=>[g("div",h,[r(i,{modelValue:C.direction,"onUpdate:modelValue":a[0]||(a[0]=e=>C.direction=e),placeholder:"方向",clearable:"",style:{width:"120px"},size:"small",onChange:S},{default:d(()=>[r(t,{label:"上游同步",value:"upstream"}),r(t,{label:"下游同步",value:"downstream"})]),_:1},8,["modelValue"]),r(i,{modelValue:C.event,"onUpdate:modelValue":a[1]||(a[1]=e=>C.event=e),placeholder:"事件",clearable:"",style:{width:"120px"},size:"small",onChange:S},{default:d(()=>[r(t,{label:"全量同步",value:"full_sync"}),r(t,{label:"用户创建",value:"user_create"}),r(t,{label:"用户更新",value:"user_update"}),r(t,{label:"用户删除",value:"user_delete"}),r(t,{label:"密码修改",value:"password_change"}),r(t,{label:"状态变更",value:"user_status_change"})]),_:1},8,["modelValue"]),r(i,{modelValue:C.status,"onUpdate:modelValue":a[2]||(a[2]=e=>C.status=e),placeholder:"状态",clearable:"",style:{width:"100px"},size:"small",onChange:S},{default:d(()=>[r(t,{label:"成功",value:"success"}),r(t,{label:"部分成功",value:"partial"}),r(t,{label:"失败",value:"failed"})]),_:1},8,["modelValue"]),r(o,{modelValue:C.dateRange,"onUpdate:modelValue":a[3]||(a[3]=e=>C.dateRange=e),type:"daterange","range-separator":"-","start-placeholder":"开始","end-placeholder":"结束","value-format":"YYYY-MM-DD",style:{width:"220px"},size:"small",clearable:"",onChange:S},null,8,["modelValue"]),r(T,{type:"primary",size:"small",onClick:S},{default:d(()=>[...a[6]||(a[6]=[m("搜索",-1)])]),_:1})])]),default:d(()=>[p((u(),c(j,{data:x.value,border:"",size:"small","row-key":"id",style:{width:"100%"}},{default:d(()=>[r(E,{type:"expand"},{default:d(({row:e})=>[g("div",w,[e.detail?(u(),s("div",f,v(e.detail),1)):(u(),s("div",b,"暂无详细信息"))])]),_:1}),r(E,{label:"时间",width:"155"},{default:d(({row:e})=>{return[m(v((a=e.createdAt,a?new Date(a).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-")),1)];var a}),_:1}),r(E,{label:"方向",width:"100",align:"center"},{default:d(({row:e})=>[r(Y,{type:"upstream"===e.direction?"primary":"success",size:"small"},{default:d(()=>[m(v("upstream"===e.direction?"上游同步":"下游同步"),1)]),_:2},1032,["type"])]),_:1}),r(E,{prop:"triggerType",label:"触发",width:"70",align:"center"},{default:d(({row:e})=>[r(Y,{size:"small",type:"event"===e.triggerType?"warning":"schedule"===e.triggerType?"primary":"info"},{default:d(()=>[m(v(R[e.triggerType]||e.triggerType),1)]),_:2},1032,["type"])]),_:1}),r(E,{prop:"triggerEvent",label:"事件",width:"100"},{default:d(({row:e})=>[m(v(U[e.triggerEvent]||e.triggerEvent||"-"),1)]),_:1}),r(E,{prop:"status",label:"状态",width:"80",align:"center"},{default:d(({row:e})=>[r(Y,{type:"success"===e.status?"success":"partial"===e.status?"warning":"danger",size:"small"},{default:d(()=>[m(v(D[e.status]||e.status),1)]),_:2},1032,["type"])]),_:1}),r(E,{prop:"message",label:"概要","min-width":"250","show-overflow-tooltip":""})]),_:1},8,["data"])),[[M,l.value]]),g("div",z,[g("span",V,"共 "+v(k.total)+" 条",1),r(L,{"current-page":k.page,"onUpdate:currentPage":a[4]||(a[4]=e=>k.page=e),"page-size":k.size,"onUpdate:pageSize":a[5]||(a[5]=e=>k.size=e),total:k.total,"page-sizes":[20,50,100],layout:"sizes, prev, pager, next",onCurrentChange:S,onSizeChange:S},null,8,["current-page","page-size","total"])])]),_:1})])}}}),[["__scopeId","data-v-3508e2ae"]]);export{x as default};
